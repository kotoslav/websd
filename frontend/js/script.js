(()=>{"use strict";class e{#e=0;priceDisplay=document.querySelector("div.calculator__button");orderButton=document.querySelector("button.calculator__button");constructor(){this.form=document.querySelector(".calculator__form"),this.request={Цена:0},this.form.querySelectorAll(".question__input").forEach((e=>{e.addEventListener("change",this.calcAll.bind(this))})),this.orderButton.addEventListener("click",this.callOrder.bind(this)),this.price=0}get price(){return this.#e}set price(e){this.#e=e,this.request["Цена"]=e,this.priceDisplay.textContent="от "+new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(this.price)}calcAll(){let e=0;const t=Array.from(this.form.querySelector("fieldset").querySelectorAll("input")).find((e=>e.checked));t&&(e=Number(this.form.querySelector("#q3-a1").checked?t.dataset.without:t.dataset.design)),e+=Array.from(document.querySelectorAll('.calculator-question[data-include="1"]')).reduce(((e,t)=>e+Array.from(t.querySelectorAll("input")).reduce(((e,t)=>t.checked?Number(t.value)+e:e),0)),0),this.price=e}callOrder(){document.querySelectorAll(".calculator-question").forEach((e=>{const t=Array.from(e.querySelectorAll(".question__input")).reduce(((e,t)=>(t.checked&&e.push(t.parentElement.textContent.trim()),e)),[]),n=e.querySelector(".calculator__title").textContent;1==t.length?this.request[n]=t[0]:0==t.length?this.request[n]=null:this.request[n]=t})),document.dispatchEvent(new CustomEvent("modalopen")),document.dispatchEvent(new CustomEvent("callorder",{detail:this.request}))}}class t extends HTMLElement{template='<div class="form__block">\n                    <div class="form__content">\n                        <div class="form__title">Оставьте заявку</div>\n                        <div class="form__subtitle">Мы свяжемся с Вами, ответим на интересующие вопросы.</div>\n                    </div>\n                    <div class="form__group">\n                        <input class="form__input" type="text" name="name" id="name" required="" placeholder="Введите имя">\n                    </div>\n                    <div class="form__group">\n                        <input class="form__input" type="text" name="email-phone" id="email-phone" required="" placeholder="Введите номер телефона или E-mail">\n                    </div>\n                    <div class="form__button">\n                        <button type="submit" class="button button--form">Отправить</button>\n                    </div>\n                </div>';constructor(){super(),this.form=document.createElement("form"),this.form.innerHTML=this.template,this.form.classList.add("form"),this.appendChild(this.form),this.callorder=null,document.addEventListener("callorder",function(e){this.callorder=e.detail}.bind(this)),this.querySelector("form").addEventListener("submit",this.sendForm.bind(this))}async sendForm(e){e.preventDefault();const t=this,n={Имя:t.querySelector("input[name='name']").value,Контакты:t.querySelector("input[name='email-phone']").value,...t.callorder},o=JSON.stringify(n);fetch("/api/callback",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:o}),document.dispatchEvent(new CustomEvent("modalclose"))}}class n extends t{constructor(){super(),this.form.classList.add("_anim-items"),this.form.setAttribute("id","form-animation")}}class o extends HTMLElement{template='<div class="modal_window" style="\n      width: 100%;\n      height: 100%;\n      position: fixed;\n      top: 0px;\n      left: 0px;\n      background-color: rgba(0, 0, 0, 0.3);\n      z-index: 999;\n      ">\n      <div class="model_form" style="\n      display:flex;\n      width: 100%;\n      height: 100%;\n      align-items: center;\n      justify-content: center;\n    ">\n\t<div class="scroll" style="position: relative">\n\t<div class="modalClose" style="\n      position: absolute;\n      cursor: pointer;\n      top: 20px;\n      right: 20px;\n      font-size: 32px;\n\t">&#10005</div>\n\t<callback-form></callback-form>\n\t</div>\n\t</div>\n\t</div>\n\t';constructor(){super(),this.form=document.createElement("div"),this.form.innerHTML=this.template,this.style.display="none",this.appendChild(this.form),document.addEventListener("modalopen",function(){this.style.display="block"}.bind(this)),document.addEventListener("modalclose",function(){this.style.display="none"}.bind(this)),this.querySelector(".modalClose").addEventListener("click",(function(){document.dispatchEvent(new CustomEvent("modalclose"))})),this.querySelector(".modal_window").addEventListener("click",(function(e){e.composedPath().includes(this.querySelector(".scroll"))||document.dispatchEvent(new CustomEvent("modalclose"))})),this.scrollable=this.querySelector("div.scroll"),this.scrollable.addEventListener("wheel",function(e){const t=e.deltaY,n=this.scrollable.scrollHeight,o=this.scrollable.offsetHeight,i=this.scrollable.scrollTop;(0===i&&t<0||o+i===n&&t>0)&&e.preventDefault()}.bind(this))}}window.addEventListener("DOMContentLoaded",(()=>{{const e=document.querySelectorAll(".button-sticky"),t=document.querySelector(".contacts"),n=new IntersectionObserver(((e,n)=>{e.forEach((e=>{if(e.isIntersecting)e.target.refClone&&e.target.refClone.remove();else{const n=e.target.cloneNode(!0);n.classList.add("button-top"),n.classList.contains("orderCall")&&n.addEventListener("click",(function(){document.dispatchEvent(new CustomEvent("modalopen"))})),e.target.refClone=n,t.appendChild(n)}}))}),{rootMargin:"-100px 0px 0px 0px"});e.forEach((e=>n.observe(e)))}customElements.define("callback-form",t),customElements.define("callback-formindex",n),document.body.appendChild(document.createElement("modal-window")),customElements.define("modal-window",o),document.querySelectorAll(".orderCall").forEach((e=>{e.addEventListener("click",(function(){document.dispatchEvent(new CustomEvent("modalopen"))}))}));try{new e}catch(e){}!function(){const e=document.querySelectorAll("._anim-items");if(e.length>0){function t(t){for(let t=0;t<e.length;t++){const o=e[t],i=o.offsetHeight,s=n(o).top,c=4;let l=window.innerHeight-i/c;i>window.innerHeight&&(l=window.innerHeight-window.innerHeight/c),scrollY>s-l&&scrollY<s+i?o.classList.add("_active"):o.classList.contains("_anim-no-hide")||o.classList.remove("_active")}const o=document.querySelector("#form-animation");o.classList.contains("_active")&&(o.classList.add("animate__animated"),o.classList.add("animate__pulse"))}function n(e){const t=e.getBoundingClientRect(),n=window.scrollX||document.documentElement.scrollLeft,o=scrollY||document.documentElement.scrollTop;return{top:t.top+o,left:t.left+n}}window.addEventListener("scroll",t),setTimeout((()=>{t()}),100)}}()})),window.addEventListener("scroll",(function(){0!=window.pageYOffset?document.querySelector(".contacts").classList.add("active"):document.querySelector(".contacts").classList.remove("active")})),document.querySelector(".menu-toggle").addEventListener("click",(()=>{document.querySelector(".contacts").style.opacity="0"==document.querySelector(".contacts").style.opacity?"1":"0"}))})();